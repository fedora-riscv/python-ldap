From e587e8a3020a2967e95278e80a98f4a86b2fd861 Mon Sep 17 00:00:00 2001
From: Christian Heimes <cheimes@redhat.com>
Date: Wed, 10 Jan 2018 14:53:44 +0100
Subject: [PATCH] Ignore SASL methods in DSE test

Closes: https://github.com/python-ldap/python-ldap/issues/160
Signed-off-by: Christian Heimes <cheimes@redhat.com>
---
 Tests/t_ldapobject.py | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/Tests/t_ldapobject.py b/Tests/t_ldapobject.py
index 27deadc..2c8ce75 100644
--- a/Tests/t_ldapobject.py
+++ b/Tests/t_ldapobject.py
@@ -520,12 +520,15 @@ class Test00_SimpleLDAPObject(SlapdTestCase):
         dse = self._ldap_conn.read_rootdse_s()
         self.assertIsInstance(dse, dict)
         self.assertEqual(dse[u'supportedLDAPVersion'], [b'3'])
+        keys = set(dse)
+        # SASL info may be missing in restricted build environments
+        keys.discard(u'supportedSASLMechanisms')
         self.assertEqual(
-            sorted(dse),
-            [u'configContext', u'entryDN', u'namingContexts', u'objectClass',
+            keys,
+            {u'configContext', u'entryDN', u'namingContexts', u'objectClass',
              u'structuralObjectClass', u'subschemaSubentry',
              u'supportedControl', u'supportedExtension', u'supportedFeatures',
-             u'supportedLDAPVersion', u'supportedSASLMechanisms']
+             u'supportedLDAPVersion'}
         )
         self.assertEqual(
             self._ldap_conn.get_naming_contexts(),
-- 
2.14.3

